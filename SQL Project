SELECT 
    MIN(Start_Date) AS Project_Start, 
    MAX(End_Date) AS Project_End
FROM (
    SELECT 
        Task_ID,
        Start_Date,
        End_Date,
        SUM(is_new) OVER (ORDER BY Start_Date) AS grp
    FROM (
        SELECT 
            Task_ID,
            Start_Date,
            End_Date,
            CASE 
                WHEN Start_Date = LAG(End_Date) OVER (ORDER BY Start_Date) 
                THEN 0 
                ELSE 1 
            END AS is_new
        FROM Projects
    ) t
) g
GROUP BY grp
ORDER BY DATEDIFF(MAX(End_Date), MIN(Start_Date)), MIN(Start_Date);
