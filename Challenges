SELECT h.hacker_id, h.name, COUNT(c.challenge_id) AS total_challenges
FROM Hackers h
JOIN Challenges c
  ON h.hacker_id = c.hacker_id
GROUP BY h.hacker_id, h.name
HAVING 
    COUNT(c.challenge_id) = (
        SELECT MAX(cnt) 
        FROM (
            SELECT COUNT(challenge_id) AS cnt
            FROM Challenges
            GROUP BY hacker_id
        ) AS sub
    )
    OR COUNT(c.challenge_id) IN (
        SELECT cnt
        FROM (
            SELECT COUNT(challenge_id) AS cnt
            FROM Challenges
            GROUP BY hacker_id
        ) AS sub
        GROUP BY cnt
        HAVING COUNT(cnt) = 1
    )
ORDER BY total_challenges DESC, h.hacker_id;
